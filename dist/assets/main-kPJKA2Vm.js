import"./main-B6YXdTMh.js";document.addEventListener("DOMContentLoaded",()=>{const t=window.location.pathname.split("/").pop()||"index.html";document.querySelectorAll(".nav-link").forEach(n=>{n.classList.remove("active"),n.getAttribute("href")===t&&n.classList.add("active")})});document.addEventListener("click",t=>{if(t.target.tagName==="A"&&t.target.getAttribute("href").startsWith("#")){t.preventDefault();const e=t.target.getAttribute("href").slice(1),n=document.getElementById(e);n&&n.scrollIntoView({behavior:"smooth",block:"start"})}});document.addEventListener("submit",t=>{const e=t.target.querySelector('button[type="submit"]');if(e){const n=e.textContent;e.textContent="Processing...",e.disabled=!0,setTimeout(()=>{e.textContent=n,e.disabled=!1},2e3)}});document.addEventListener("DOMContentLoaded",()=>{m()});let s={},i=[];async function m(){await f(),y(),g()}async function f(){try{await h()}catch(t){console.error("Backend failed, trying local files:",t);try{const[e,n]=await Promise.all([fetch("/iller_ilceler.json"),fetch("src/assets/dummyjson/restaurant.json")]);if(!e.ok||!n.ok)throw new Error("Veri yüklenemedi");s=await e.json(),i=await n.json(),console.log("✅ Loaded from local files")}catch(e){console.error("Local files failed:",e),d()}}}async function h(){try{const t=await fetch("http://localhost:5000/api/restaurants");t.ok?(i=(await t.json()).data||[],console.log("✅ Loaded restaurants from backend:",i.length),s={},i.forEach(n=>{const a=n.city||"İstanbul",o=n.district||n.location;s[a]||(s[a]=[]),s[a].includes(o)||s[a].push(o)}),console.log("✅ Created city-district mapping:",s)):d()}catch(t){console.error("Backend fallback failed:",t),d()}}function d(){console.log("Using hardcoded fallback data"),s={İstanbul:["Beşiktaş","Kadıköy","Ortaköy"],Ankara:["Çankaya","Keçiören"],İzmir:["Konak","Bornova"]},i=[]}function y(){const t=document.getElementById("citySelect");t.innerHTML='<option value="">Şehir seçin</option>',Object.keys(s).forEach(e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)})}function g(){const t=document.getElementById("citySelect"),e=document.getElementById("districtSelect"),n=document.getElementById("findRestaurants");t.addEventListener("change",v),e.addEventListener("change",p),n.addEventListener("click",E)}function v(){const t=document.getElementById("citySelect"),e=document.getElementById("districtSelect"),n=document.getElementById("findRestaurants"),a=t.value,o=s[a]||[];e.innerHTML='<option value="">İlçe seçin</option>',e.disabled=!o.length,n.disabled=!0,o.forEach(c=>{const r=document.createElement("option");r.value=c,r.textContent=c,e.appendChild(r)}),document.getElementById("restaurantResults").classList.add("hidden")}function p(){const t=document.getElementById("districtSelect"),e=document.getElementById("findRestaurants");e.disabled=!t.value}async function E(){const t=document.getElementById("citySelect").value,e=document.getElementById("districtSelect").value;if(!t||!e)return;try{const a=await fetch(`http://localhost:5000/api/restaurants?city=${encodeURIComponent(t)}&district=${encodeURIComponent(e)}`);if(a.ok){const o=await a.json();l(o.data||[],t,e),console.log(`✅ Loaded ${o.count} restaurants for ${t}/${e} from backend`);return}}catch(a){console.warn("⚠️ Backend filter failed, using local data:",a)}const n=i.filter(a=>a.city===t&&a.district===e);l(n,t,e)}function l(t,e,n){const a=document.getElementById("resultsTitle"),o=document.getElementById("restaurantGrid"),c=document.getElementById("restaurantResults");a.textContent=`${n}, ${e} bölgesindeki restoranlar`,o.innerHTML="",t.length===0?o.innerHTML=`
      <div class="no-restaurants">
        <div class="no-data-icon">🏪</div>
        <h3>Restoran bulunamadı</h3>
        <p>Bu bölgede henüz restoran verisi bulunmamaktadır.</p>
      </div>`:t.forEach(r=>{const u=b(r);o.appendChild(u)}),c.classList.remove("hidden"),c.scrollIntoView({behavior:"smooth"})}function b(t){const e=document.createElement("div");return e.className="restaurant-card",e.innerHTML=`
    <div class="restaurant-image">
      <img src="${t.image}" alt="${t.name}">
    </div>
    <div class="restaurant-content">
      <h3>${t.name}</h3>
      <p class="restaurant-address">${t.district}, ${t.city}</p>
      <div class="restaurant-actions">
        <button class="view-details-btn" onclick="window.location.href='restaurant.html?id=${t.id}'">
          Detaylar
        </button>
        <button class="quick-reserve-btn" onclick="window.location.href='reservation.html?restaurant=${t.id}'">
          Hızlı Rezervasyon
        </button>
      </div>
    </div>
  `,e}

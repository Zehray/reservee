var i=(e,t,o)=>new Promise((g,R)=>{var T=a=>{try{v(o.next(a))}catch(p){R(p)}},D=a=>{try{v(o.throw(a))}catch(p){R(p)}},v=a=>a.done?g(a.value):Promise.resolve(a.value).then(T,D);v((o=o.apply(e,t)).next())});import"./main-1wRwdB3J.js";import{s as d,f as I,a as k}from"./utils-BuTwOXtE.js";import{r as B,h as E}from"./api-CctCSKT1.js";let n=[],r=[],A="date",c,s,u,m,f,h,w;function C(){return i(this,null,function*(){if(c=document.getElementById("reservationsTableBody"),s=document.getElementById("totalReservations"),u=document.getElementById("noReservations"),m=document.querySelector(".table-container"),f=document.getElementById("dateFilter"),h=document.getElementById("sortBy"),w=document.getElementById("clearAllData"),!c||!s||!u||!m||!f||!h||!w){console.error("Required admin dashboard elements not found");return}s&&(s.textContent="Loading..."),yield y(),l(),S()})}function y(){return i(this,null,function*(){try{n=(yield B.getAll()).data||[],console.log("✅ Loaded reservations from backend:",n.length),d.set("reservations",n)}catch(e){console.warn("⚠️ Backend load failed, using localStorage fallback"),E(e,"loading reservations"),n=d.get("reservations")||[],console.warn("Loaded from localStorage:",n.length,"reservations")}r=[...n]})}function S(){f.addEventListener("change",L),h.addEventListener("change",e=>{A=e.target.value,$(),l()}),w.addEventListener("click",P),setInterval(()=>{y(),b(),l()},3e4)}function L(){const e=f.value;e?r=n.filter(t=>t.date===e):r=[...n],$(),l()}function $(){r.sort((e,t)=>{switch(A){case"name":return e.fullName.localeCompare(t.fullName);case"guests":return parseInt(t.guests)-parseInt(e.guests);case"time":return e.time.localeCompare(t.time);case"date":default:const o=new Date("".concat(e.date,"T").concat(e.time)),g=new Date("".concat(t.date,"T").concat(t.time));return o-g}})}function b(){L()}function l(){if(x(),r.length===0){N();return}q(),F()}function x(){s.textContent="Total: ".concat(r.length)}function N(){m.style.display="none",u.style.display="block"}function q(){m.style.display="block",u.style.display="none"}function F(){c.innerHTML="",r.forEach(e=>{const t=M(e);c.appendChild(t)})}function M(e){const t=document.createElement("tr");return t.innerHTML="\n    <td>".concat(e.fullName,"</td>\n    <td>").concat(e.phoneNumber,"</td>\n    <td>").concat(e.email,"</td>\n    <td>").concat(I(e.date),"</td>\n    <td>").concat(k(e.time),"</td>\n    <td>").concat(e.guests,"</td>\n    <td>").concat(e.specialRequests||"-",'</td>\n    <td>\n      <button class="delete-btn" onclick="deleteReservation(\'').concat(e.id,'\')"\n              style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">\n        Delete\n      </button>\n    </td>\n  '),t}function H(e){return i(this,null,function*(){if(confirm("Are you sure you want to delete this reservation?")){try{yield B.delete(e),console.log("✅ Reservation deleted from backend"),n=n.filter(t=>t.id!==e),d.set("reservations",n)}catch(t){console.warn("⚠️ Backend delete failed, deleting locally only"),E(t,"deleting reservation"),n=n.filter(o=>o.id!==e),d.set("reservations",n)}yield y(),b(),l()}})}function P(){confirm("Are you sure you want to delete ALL reservations? This action cannot be undone.")&&(d.remove("reservations"),y(),b(),l(),alert("All reservation data has been cleared."))}document.addEventListener("DOMContentLoaded",C);window.deleteReservation=H;
